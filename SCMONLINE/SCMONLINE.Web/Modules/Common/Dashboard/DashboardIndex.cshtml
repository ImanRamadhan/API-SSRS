@model SCMONLINE.Common.DashboardPageModel
@using Serenity.Services;
@using Serenity.Core;
@using SCMONLINE.Common.Pages
@using SCMONLINE.Inbox.Entities
@using SCMONLINE.Common.Pages
@using SCMONLINE.Procurement
@using SCMONLINE.App_Start
@using SCMONLINE.BasicSamples
@*@Html.AppSourceFile("DialogBoxes.ts")*@

@{
    ViewData["Title"] = "Dashboard";
    ViewData["PageId"] = "Dashboard";
}

@section Head {
    @Html.StyleBundle("Pages/Dashboard")
    @Html.ScriptBundle("Pages/Dashboard")
    <!--<script src="~/Scripts/chartjs/Chart.min.js"></script>-->
    @*<script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js'></script>*@
    <script src="https://rawgit.com/chartjs/chartjs.github.io/master/dist/master/Chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-piechart-outlabels"></script>
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Lato'>
}

@section ContentHeader {
    <h1>@LocalText.Get("Navigation.Dashboard")</h1>
}
<style>
    svg:not(:root) {
        height: 100% !important;
    }
</style>

@*<!-- Small boxes (Stat box) -->
    <div class="row">
        <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-aqua">
                <div class="inner">
                    <h3>@Model.OpenOrders</h3>
                    <p>Open Orders</p>
                </div>
                <div class="icon">
                    <i class="ion ion-bag"></i>
                </div>
                <a href="~/Northwind/Order?shippingState=0" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
            </div>
        </div><!-- ./col -->
        <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-green">
                <div class="inner">
                    <h3>@Model.ClosedOrderPercent<sup style="font-size: 20px">%</sup></h3>
                    <p>Closed Orders</p>
                    <label>Hallo World</label>
                </div>
                <div class="icon">
                    <i class="ion ion-stats-bars"></i>
                </div>
                <a href="~/Northwind/Order?shippingState=1" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
            </div>
        </div><!-- ./col -->
        <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-yellow">
                <div class="inner">
                    <h3>@Model.CustomerCount</h3>
                    <p>Total Customers</p>
                </div>
                <div class="icon">
                    <i class="ion ion-person-add"></i>
                </div>
                <a href="~/Northwind/Customer" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
            </div>
        </div><!-- ./col -->
        <div class="col-lg-3 col-xs-6">
            <!-- small box -->
            <div class="small-box bg-red">
                <div class="inner">
                    <h3>@Model.ProductCount</h3>
                    <p>Different Products</p>
                </div>
                <div class="icon">
                    <i class="ion ion-pie-graph"></i>
                </div>
                <a href="~/Northwind/Product" class="small-box-footer">More info <i class="fa fa-arrow-circle-right"></i></a>
            </div>
        </div><!-- ./col -->
    </div><!-- /.row -->*@
<!-- Main row -->
<div class="row">
    <!-- Left col -->
    @*<section class="col-lg-12 connectedSortable">*@
    <section class="col-lg-12">
        <div class="nav-tabs-custom">
            <!-- Tabs within a box -->
            @*<div class="input-group-addon">
                                <i class="fa fa-calendar"></i>
                            </div>
                            <input type="text" width="200px" name="StartDate" class="form-control pull-right" id="StartDate">
                    </div><!-- /.input group -->
                </div><!-- /.form group -->
                <div class="form-group">
                        <label>Date End:</label>
                        <div class="input-group">
                            <div class="input-group-addon">
                                <i class="fa fa-calendar"></i>
                            </div>
                            <input type="text" width="200px" name="EndDate" class="form-control pull-right" id="EndDate" onchange="addGraphDate()">
                        </div><!-- /.input group -->
                    </div><!-- /.form group -->*@
            @*<div class="box-footer">
                    <button type="submit" class="btn btn-info pull-right" onclick="location.href='<%: Url.Action()'">Generate</button
                </div>*@<!-- /.box-footer -->

            <ul class="nav nav-tabs pull-right">
                @*<li><a href="#revenue-chart" data-toggle="tab">Area</a></li>*@
                @*<li class="active"><a href="#sales-chart" data-toggle="tab">Donut</a></li>*@
                <li class="pull-left header"><i class="fa fa-inbox"></i> Status Proses PR </li>
            </ul>


            <div class="tab-contentx no-paddingx">
                <!-- Morris chart - Sales -->
                @*<div class="chart tab-pane " id="revenue-chart" style="position: relative; height: 300px;"></div>*@
                <div id="MyBarx">
                    @*<div class="chart tab-pane active" id="sales-chart" style="position: relative; height: 550px;"></div>*@
                </div>
                @*(&& Serenity.Authorization.Username != "admin")*@
                @if (Serenity.Authorization.HasPermission(ProcurementPermission.DashboardAdmin) && Serenity.Authorization.Username != "Vendor")
                {
                    <p>Ini Admin</p>
                    <canvas id="sales-chartx"></canvas>
                }
                @if (Serenity.Authorization.HasPermission(ProcurementPermission.DashboardVendor) && Serenity.Authorization.Username != "admin")
                {
                    <p>Ini Vendor</p>
                    <canvas id="sales-chartuser"></canvas>
                }
                @*<canvas id="sales-chartx"></canvas>*@

                <div class="form-group" style="visibility:hidden;">
                    <label>Choose Date:</label>
                    <div class="input-group">
                        <div id="reportrange" style="background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc; width: 100%">
                            <i class="fa fa-calendar"></i>&nbsp;
                            <span></span> <i class="fa fa-caret-down"></i>
                        </div>
                    </div>
                </div>

                <div id="data"></div>
            </div>
        </div><!-- /.nav-tabs-custom -->
        <!-- Custom tabs (Charts with tabs)
        <div class="nav-tabs-custom">
            // Tabs within a box
            <ul class="nav nav-tabs pull-right">
                <li class="active"><a href="#revenue-chart" data-toggle="tab">Area</a></li>
                <li><a href="#sales-chart" data-toggle="tab">Donut</a></li>
                <li class="pull-left header"><i class="fa fa-inbox"></i> Sales</li>
            </ul>
            <div class="tab-content no-padding">
                // Morris chart - Sales
                <div class="chart tab-pane active" id="revenue-chart" style="position: relative; height: 300px;"></div>
                <div class="chart tab-pane" id="sales-chart" style="position: relative; height: 300px;"></div>
            </div>
        </div><!-- /.nav-tabs-custom -->
        <!-- Custom tabs (Charts with tabs)-->
        <div class="nav-tabs-custom">
            <!-- Tabs within a box -->
            <ul class="nav nav-tabs pull-right">
                @*<li class="active"><a href="#redsales-chart" data-toggle="tab">Donut</a></li>*@
                <li class="pull-left header"><i class="fa fa-inbox"></i> Dashboard Ast.Man.Porc/manager Proc</li>
            </ul>
            <div class="tab-content no-padding">
                <div id="chart-wrapper">
                    <canvas id="redsales-chart"></canvas>
                </div>
            </div>
        </div><!-- /.nav-tabs-custom -->
        <!-- BAR CHART -->
        @if (Serenity.Authorization.HasPermission(ProcurementPermission.DashboardAdmin))
        {
            <div class="box box-success">
                <div class="box-header with-border">
                    <h3 class="box-title">Status PR Buyer</h3>
                    <div class="box-tools pull-right">
                        <button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        <button class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <div class="chart">
                        <canvas id="ReddensityChartFC" style="height:630px"></canvas>
                    </div>
                </div><!-- /.box-body -->
            </div><!-- /.box -->
        }
        @if (Serenity.Authorization.HasPermission(ProcurementPermission.DashboardVendor))
        {
            <div class="box box-success" style="visibility:hidden;">
                <div class="box-header with-border">
                    <h3 class="box-title">Status PR Buyer</h3>
                    <div class="box-tools pull-right">
                        <button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        <button class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <div class="chart">
                        <canvas id="ReddensityChartFC" style="height:130px"></canvas>
                    </div>
                </div><!-- /.box-body -->
            </div><!-- /.box -->
        }

        <!-- HORIZONTAL BAR CHART -->
        @*<div class="box box-success">
                <div class="box-header with-border">
                    <h3 class="box-title">Horizontal Bar Chart</h3>
                    <div class="box-tools pull-right">
                        <button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        <button class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body">
                    <div class="chart">
                        <!-- canvas id="barChart" style="height:230px"></canvas> -->
                        <canvas id="densityChart" width="600" height="400"></canvas>
                    </div>
                </div><!-- /.box-body -->
            </div><!-- /.box -->*@
        <!-- Chat box
        <div class="box box-success">
            <div class="box-header">
                <i class="fa fa-comments-o"></i>
                <h3 class="box-title">Chat</h3>
                <div class="box-tools pull-right" data-toggle="tooltip" title="Status">
                    <div class="btn-group" data-toggle="btn-toggle">
                        <button type="button" class="btn btn-default btn-sm active"><i class="fa fa-square text-green"></i></button>
                        <button type="button" class="btn btn-default btn-sm"><i class="fa fa-square text-red"></i></button>
                    </div>
                </div>
            </div>
            <div class="box-body chat" id="chat-box">
                <!-- chat item
                <div class="item">
                    <img src="~/Content/adminlte/img/avatar.png" alt="user image" class="online">
                    <p class="message">
                        <a href="#" class="name">
                            <small class="text-muted pull-right"><i class="fa fa-clock-o"></i> 2:15</small>
                            Mike Doe
                        </a>
                        I would like to meet you to discuss the latest news about
                        the arrival of the new theme. They say it is going to be one the
                        best themes on the market
                    </p>
                    <div class="attachment">
                        <h4>Attachments:</h4>
                        <p class="filename">
                            Theme-thumbnail-image.jpg
                        </p>
                        <div class="pull-right">
                            <button class="btn btn-primary btn-sm btn-flat">Open</button>
                        </div>
                    </div><!-- /.attachment
                </div><!-- /.item
                <!-- chat item
                <div class="item">
                    <img src="~/Content/adminlte/img/avatar2.png" alt="user image" class="offline">
                    <p class="message">
                        <a href="#" class="name">
                            <small class="text-muted pull-right"><i class="fa fa-clock-o"></i> 5:15</small>
                            Alexander Pierce
                        </a>
                        I would like to meet you to discuss the latest news about
                        the arrival of the new theme. They say it is going to be one the
                        best themes on the market
                    </p>
                </div><!-- /.item
                <!-- chat item
                <div class="item">
                    <img src="~/Content/adminlte/img/avatar5.png" alt="user image" class="offline">
                    <p class="message">
                        <a href="#" class="name">
                            <small class="text-muted pull-right"><i class="fa fa-clock-o"></i> 5:30</small>
                            Susan Doe
                        </a>
                        I would like to meet you to discuss the latest news about
                        the arrival of the new theme. They say it is going to be one the
                        best themes on the market
                    </p>
                </div><!-- /.item
            </div><!-- /.chat
            <div class="box-footer">
                <div class="input-group">
                    <input class="form-control" placeholder="Type message...">
                    <div class="input-group-btn">
                        <button class="btn btn-success"><i class="fa fa-plus"></i></button>
                    </div>
                </div>
            </div>
        </div>
         /.box (chat box) -->
        <!-- TO DO List
        <div class="box box-primary">
            <div class="box-header">
                <i class="ion ion-clipboard"></i>
                <h3 class="box-title">To Do List</h3>
                <div class="box-tools pull-right">
                    <ul class="pagination pagination-sm inline">
                        <li><a href="#">&laquo;</a></li>
                        <li><a href="#">1</a></li>
                        <li><a href="#">2</a></li>
                        <li><a href="#">3</a></li>
                        <li><a href="#">&raquo;</a></li>
                    </ul>
                </div>
            </div><!-- /.box-header
            <div class="box-body">
                <ul class="todo-list">
                    <li>
                        <!-- drag handle
                        <span class="handle">
                            <i class="fa fa-ellipsis-v"></i>
                            <i class="fa fa-ellipsis-v"></i>
                        </span>
                        <!-- checkbox
                        <input type="checkbox" value="" name="">
                        <!-- todo text
                        <span class="text">Design a nice theme</span>
                        <!-- Emphasis label
                        <small class="label label-danger"><i class="fa fa-clock-o"></i> 2 mins</small>
                        <!-- General tools such as edit or delete
                        <div class="tools">
                            <i class="fa fa-edit"></i>
                            <i class="fa fa-trash-o"></i>
                        </div>
                    </li>
                    <li>
                        <span class="handle">
                            <i class="fa fa-ellipsis-v"></i>
                            <i class="fa fa-ellipsis-v"></i>
                        </span>
                        <input type="checkbox" value="" name="">
                        <span class="text">Make the theme responsive</span>
                        <small class="label label-info"><i class="fa fa-clock-o"></i> 4 hours</small>
                        <div class="tools">
                            <i class="fa fa-edit"></i>
                            <i class="fa fa-trash-o"></i>
                        </div>
                    </li>
                    <li>
                        <span class="handle">
                            <i class="fa fa-ellipsis-v"></i>
                            <i class="fa fa-ellipsis-v"></i>
                        </span>
                        <input type="checkbox" value="" name="">
                        <span class="text">Let theme shine like a star</span>
                        <small class="label label-warning"><i class="fa fa-clock-o"></i> 1 day</small>
                        <div class="tools">
                            <i class="fa fa-edit"></i>
                            <i class="fa fa-trash-o"></i>
                        </div>
                    </li>
                    <li>
                        <span class="handle">
                            <i class="fa fa-ellipsis-v"></i>
                            <i class="fa fa-ellipsis-v"></i>
                        </span>
                        <input type="checkbox" value="" name="">
                        <span class="text">Let theme shine like a star</span>
                        <small class="label label-success"><i class="fa fa-clock-o"></i> 3 days</small>
                        <div class="tools">
                            <i class="fa fa-edit"></i>
                            <i class="fa fa-trash-o"></i>
                        </div>
                    </li>
                    <li>
                        <span class="handle">
                            <i class="fa fa-ellipsis-v"></i>
                            <i class="fa fa-ellipsis-v"></i>
                        </span>
                        <input type="checkbox" value="" name="">
                        <span class="text">Check your messages and notifications</span>
                        <small class="label label-primary"><i class="fa fa-clock-o"></i> 1 week</small>
                        <div class="tools">
                            <i class="fa fa-edit"></i>
                            <i class="fa fa-trash-o"></i>
                        </div>
                    </li>
                    <li>
                        <span class="handle">
                            <i class="fa fa-ellipsis-v"></i>
                            <i class="fa fa-ellipsis-v"></i>
                        </span>
                        <input type="checkbox" value="" name="">
                        <span class="text">Let theme shine like a star</span>
                        <small class="label label-default"><i class="fa fa-clock-o"></i> 1 month</small>
                        <div class="tools">
                            <i class="fa fa-edit"></i>
                            <i class="fa fa-trash-o"></i>
                        </div>
                    </li>
                </ul>
            </div><!-- /.box-body
            <div class="box-footer clearfix no-border">
                <button class="btn btn-default pull-right"><i class="fa fa-plus"></i> Add item</button>
            </div>
        </div> /.box -->
        <!-- solid sales graph -->
        @*<div class="box box-solid bg-teal-gradient">
                <div class="box-header">
                    <i class="fa fa-th"></i>
                    <h3 class="box-title">Sales Graph</h3>
                    <div class="box-tools pull-right">
                        <button class="btn bg-teal btn-sm" data-widget="collapse"><i class="fa fa-minus"></i></button>
                        <button class="btn bg-teal btn-sm" data-widget="remove"><i class="fa fa-times"></i></button>
                    </div>
                </div>
                <div class="box-body border-radius-none">
                    <div class="chart" id="line-chart" style="height: 250px;"></div>
                    <div class="chart" id="redline-chart" style="height: 250px;"></div>
                </div>
            </div>*@
        <!-- quick email widget
        <div class="box box-info">
            <div class="box-header">
                <i class="fa fa-envelope"></i>
                <h3 class="box-title">Quick Email</h3>
                <!-- tools box
        <div class="pull-right box-tools">
            <button class="btn btn-info btn-sm" data-widget="remove" data-toggle="tooltip" title="Remove"><i class="fa fa-times"></i></button>
        </div><!-- /. tools
            </div>
            <div class="box-body">
                <form action="#" method="post">
                    <div class="form-group">
                        <input type="email" class="form-control" name="emailto" placeholder="Email to:">
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-control" name="subject" placeholder="Subject">
                    </div>
                    <div>
                        <textarea class="textarea" placeholder="Message" style="width: 100%; height: 125px; font-size: 14px; line-height: 18px; border: 1px solid #dddddd; padding: 10px;"></textarea>
                    </div>
                </form>
            </div>
            <div class="box-footer clearfix">
                <button class="pull-right btn btn-default" id="sendEmail">Send <i class="fa fa-arrow-circle-right"></i></button>
            </div>
        </div> -->
    </section><!-- /.Left col -->
    <!-- right col (We are only adding the ID to make the widgets sortable)

    <section class="col-lg-5 connectedSortable">
        <!-- Map box
        <div class="box box-solid bg-light-blue-gradient">
            <div class="box-header">
                <!-- tools box
                <div class="pull-right box-tools">
                    <button class="btn btn-primary btn-sm daterange pull-right" data-toggle="tooltip" title="Date range"><i class="fa fa-calendar"></i></button>
                    <button class="btn btn-primary btn-sm pull-right" data-widget="collapse" data-toggle="tooltip" title="Collapse" style="margin-right: 5px;"><i class="fa fa-minus"></i></button>
                </div><!-- /. tools
                <i class="fa fa-map-marker"></i>
                <h3 class="box-title">
                    Visitors
                </h3>
            </div>
            <div class="box-body">
                <div id="world-map" style="height: 250px; width: 100%;"></div>
            </div><!-- /.box-body
            <div class="box-footer no-border">
                <div class="row">
                    <div class="col-xs-4 text-center" style="border-right: 1px solid #f4f4f4">
                        <div id="sparkline-1"></div>
                        <div class="knob-label">Visitors</div>
                    </div><!-- ./col
                    <div class="col-xs-4 text-center" style="border-right: 1px solid #f4f4f4">
                        <div id="sparkline-2"></div>
                        <div class="knob-label">Online</div>
                    </div><!-- ./col
                    <div class="col-xs-4 text-center">
                        <div id="sparkline-3"></div>
                        <div class="knob-label">Exists</div>
                    </div><!-- ./col
                </div><!-- /.row
            </div>
        </div>
        /.box -->
    <!-- /.box-body
            <div class="box-footer no-border">
                <div class="row">
                    <div class="col-xs-4 text-center" style="border-right: 1px solid #f4f4f4">
                        <input type="text" class="knob" data-readonly="true" value="20" data-width="60" data-height="60" data-fgColor="#39CCCC">
                        <div class="knob-label">Mail-Orders</div>
                    </div><!-- ./col
                    <div class="col-xs-4 text-center" style="border-right: 1px solid #f4f4f4">
                        <input type="text" class="knob" data-readonly="true" value="50" data-width="60" data-height="60" data-fgColor="#39CCCC">
                        <div class="knob-label">Online</div>
                    </div><!-- ./col
                    <div class="col-xs-4 text-center">
                        <input type="text" class="knob" data-readonly="true" value="30" data-width="60" data-height="60" data-fgColor="#39CCCC">
                        <div class="knob-label">In-Store</div>
                    </div><!-- ./col
                </div><!-- /.row
            </div><!-- /.box-footer
        </div><!-- /.box
        <!-- Calendar
        <div class="box box-solid bg-green-gradient">
            <div class="box-header">
                <i class="fa fa-calendar"></i>
                <h3 class="box-title">Calendar</h3>
                <!-- tools box
                <div class="pull-right box-tools">
                    <!-- button with a dropdown
                    <div class="btn-group">
                        <button class="btn btn-success btn-sm dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bars"></i></button>
                        <ul class="dropdown-menu pull-right" role="menu">
                            <li><a href="#">Add new event</a></li>
                            <li><a href="#">Clear events</a></li>
                            <li class="divider"></li>
                            <li><a href="#">View calendar</a></li>
                        </ul>
                    </div>
                    <button class="btn btn-success btn-sm" data-widget="collapse"><i class="fa fa-minus"></i></button>
                    <button class="btn btn-success btn-sm" data-widget="remove"><i class="fa fa-times"></i></button>
                </div><!-- /. tools
            </div><!-- /.box-header
            <div class="box-body no-padding">
                <!--The calendar
                <div id="calendar" style="width: 100%"></div>
            </div><!-- /.box-body
            <div class="box-footer text-black">
                <div class="row">
                    <div class="col-sm-6">
                        <!-- Progress bars
                        <div class="clearfix">
                            <span class="pull-left">Task #1</span>
                            <small class="pull-right">90%</small>
                        </div>
                        <div class="progress xs">
                            <div class="progress-bar progress-bar-green" style="width: 90%;"></div>
                        </div>
                        <div class="clearfix">
                            <span class="pull-left">Task #2</span>
                            <small class="pull-right">70%</small>
                        </div>
                        <div class="progress xs">
                            <div class="progress-bar progress-bar-green" style="width: 70%;"></div>
                        </div>
                    </div><!-- /.col
                    <div class="col-sm-6">
                        <div class="clearfix">
                            <span class="pull-left">Task #3</span>
                            <small class="pull-right">60%</small>
                        </div>
                        <div class="progress xs">
                            <div class="progress-bar progress-bar-green" style="width: 60%;"></div>
                        </div>
                        <div class="clearfix">
                            <span class="pull-left">Task #4</span>
                            <small class="pull-right">40%</small>
                        </div>
                        <div class="progress xs">
                            <div class="progress-bar progress-bar-green" style="width: 40%;"></div>
                        </div>
                    </div>
                    <!-- /.col
                </div><!-- /.row
            </div>
        </div><!-- /.box
    </section> right col -->



</div><!-- /.row (main row) -->
<!-- DASHBOARD -->
<link rel="stylesheet" href="~/Scripts/daterangepicker/daterangepicker-bs3.css" />
<link rel="stylesheet" href="~/Scripts/timepicker/bootstrap-timepicker.min.css" />
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.css">

<!--<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>-->
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.min.js"></script>
<script src="~/Scripts/input-mask/jquery.inputmask.js"></script>
<script src="~/Scripts/input-mask/jquery.inputmask.date.extensions.js"></script>
<script src="~/Scripts/daterangepicker/moment.min.js"></script>
<script src="~/Scripts/daterangepicker/daterangepicker.js"></script>
<script src="~/Scripts/flot/jquery.flot.min.js"></script>
<script src="~/Scripts/flot/jquery.flot.resize.min.js"></script>
<script src="~/Scripts/flot/jquery.flot.pie.min.js"></script>
<script src="~/Scripts/flot/jquery.flot.categories.min.js"></script>
@*<script src="~/Scripts/chartjs/Chart.bundle.min.js"></script>*@


<script>


    var startDate;
    var endDate;

    endDate = $("#EndDate").val();
    startDate = $("#StartDate").val();
    reportrange = $("#reportrange").val();

    //Condition to decide for calling method based on datepicker value
    var datafill;
    var dataisi;
    var dataProses;
    var dataWaiting;
    var dataPO;
    var dataB;
    var dataisiuser;
    dataisi = addDataGraphF();
    dataProses = addDataGraphsProses();
    dataWaiting = addDataGraphsWaiting();
    dataPO = addDataGraphsPO();
    dataB = addDataGraphsBuyer();
    datafill = addDataGraph();
    datafilluser = addDataGraphUser();

    function labelFormatter(label, series) {
        return "<div style='font-size:8pt; text-align:center; padding:0px; color:white;'>" + label + "<br/>" + series.data[0][1] + "</div>";
    }

    var objArrayisi = dataisi;
    console.log('objArrayisi2');
    console.log(objArrayisi);
    let resultisi = objArrayisi.map(function (a) { return a.data; });
    objArrayisilabel = dataisi;
    let resultisilabel = objArrayisilabel.map(function (a) { return a.label; });

    var cart = document.getElementById('redsales-chart').getContext('2d');
    var chartPie = new Chart(cart, {
        type: 'outlabeledPie',
        data: {
            labels: resultisilabel,
            datasets: [{
                backgroundColor: [
                    '#FF3784',
                    '#36A2EB',
                    '#4BC0C0',
                    '#F77825'
                ],
                data: resultisi
            }]
        },
        options: {
            zoomOutPercentage: 55, // makes chart 55% smaller (50% by default, if the preoprty is undefined)
            plugins: {
                legend: true,
                outlabels: {
                    text: '%l %p',
                    color: 'white',
                    stretch: 45,
                    font: {
                        resizable: true,
                        minSize: 12,
                        maxSize: 18
                    }
                }
            }
        }
    });

    objArrayHorizontal = datafill;
    let resultHorizontal = objArrayHorizontal.map(function (a) { return a.value; });
    objArrayHorizontallabel = datafill;
    let resultHorizontallabel = objArrayHorizontallabel.map(function (a) { return a.label; });

    objArrayHorizontalUser = datafilluser;
    let resultHorizontalUser = objArrayHorizontalUser.map(function (a) { return a.value; });
    objArrayHorizontallabelUser = datafilluser;
    let resultHorizontallabelUser = objArrayHorizontallabelUser.map(function (a) { return a.label; });
    var barOptions = {
        plugins: {
            legend: true,
            outlabels: {
                text: '%l %p',
                color: 'white',
                stretch: 45,
                font: {
                    resizable: true,
                    minSize: 12,
                    maxSize: 18
                }
            }
        },
        events: true,
        showTooltips: true,
        animation: {
            duration: 1000,
            easing: "easeOutQuart",

            onComplete: function () {
                var ctx = this.chart.ctx;
                ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontFamily, 'normal', Chart.defaults.global.defaultFontFamily);
                ctx.textAlign = 'left';
                ctx.textBaseline = 'bottom';

                this.data.datasets.forEach(function (dataset) {
                    console.log(dataset);
                    for (var i = 0; i < dataset.data.length; i++) {
                        var model2 = dataset._meta[Object.keys(dataset._meta)[0]].data[i].$outlabels
                        var model = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._model,
                            scale_max = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._yScale.maxHeight;
                        left = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._xScale.left;
                        offset = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._xScale.longestLabelWidth;
                        ctx.fillStyle = '#333';
                        console.log(model);
                        console.log(model2);
                        var y_pos = model.y - 5;
                        var label = model2.value;
                        console.log(label);
                        // Make sure data value does not get overflown and hidden
                        // when the bar's value is too close to max value of scale
                        // Note: The y value is reverse, it counts from top down
                        if ((scale_max - model.y) / scale_max >= 0.93)
                            y_pos = model.y + 20;
                        // ctx.fillText(dataset.data[i], model.x, y_pos);
                        ctx.fillText(label, left + 10, model.y + 8);
                    }
                });
            }
        }
    };
    
    objArrayProses = dataProses;
    console.log('objArrayProses');
    console.log(objArrayProses);
    let resultProses = objArrayProses.map(function (a) { return a.y;});
    console.log('resultProses');
    console.log(resultProses);
    objArrayWaiting = dataWaiting;
    let resultWaiting = objArrayWaiting.map(function (a) { return a.y; });
    objArrayPO = dataPO;
    let resultPO = objArrayPO.map(function (a) { return a.y; });
    objArrayBuyer = dataB;
    let resultBuyer = objArrayBuyer.map(function (a) { return a.nameBuyer; });

    var ctx = document.getElementById('ReddensityChartFC').getContext('2d');
    var chart = new Chart(ctx, {
        // The type of chart we want to create
        type: 'bar',
        // The data for our dataset
        data: {
            labels: resultBuyer,
            datasets: [
                {
                    label: "Proses",
                    backgroundColor: 'rgb(255, 99, 132)',
                    borderColor: 'rgb(255, 99, 132)',
                    data: resultProses,
                }, {
                    label: "Waiting",
                    backgroundColor: 'rgb(99, 255, 132)',
                    borderColor: 'rgb(99, 255, 132)',
                    data: resultWaiting,
                }, {
                    label: "PO",
                    backgroundColor: 'rgb(99, 132, 255)',
                    borderColor: 'rgb(99, 132, 255)',
                    data: resultPO,
                }]
        },
        // Configuration options go here
        options: {}
    });

    //method for calling data graph without parameters
    function addDataGraph() {

        console.log('Cek Data Kau');
        console.log('Dashboard/GetData');

        var data = "";
        $.ajax({
            type: 'POST',
            //url: 'Dashboard/GetData',
            url: '@Url.Action("GetData")',
            dataType: 'json',
            async: false,
            contentType: "application/json; charset=utf-8",
            data: {},
            success: function (result) {
                console.log('Cek Data COba an yang hqq');
                data = result;

                console.log(data);
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });
        return data;
    }

    function addDataGraphUser() {

        console.log('CekUser');
        console.log('Dashboard/GetDataUser');

        var data = "";
        $.ajax({
            type: 'POST',
            url: '@Url.Action("GetDataUser")',
            dataType: 'json',
            async: false,
            contentType: "application/json; charset=utf-8",
            data: {},
            success: function (result) {
                console.log('Cek Data yang hqq');
                data = result;

                console.log(data);
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });
        return data;
    }

    function addDataGraphF() {

        console.log('Cek Data3');
        //console.log('Dashboard/GetData2');

        var data = "";
        $.ajax({
            type: 'POST',
            //url: 'Dashboard/GetData2',
            url: '@Url.Action("GetData2")',
            dataType: 'json',
            async: false,
            contentType: "application/json; charset=utf-8",
            data: {},
            success: function (result) {

                data = result;
                console.log(data);

                //bluedonut.setData(data);
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });
        return data;
    }

    function addDataGraphsProses() {

        console.log('Cek DataProses');
        //console.log('Dashboard/GetData2');

        var data = "";
        $.ajax({
            type: 'POST',
            //url: '/Dashboard/GetDataProses',
            url: '@Url.Action("GetDataProses")',
            dataType: 'json',
            async: false,
            contentType: "application/json; charset=utf-8",
            data: {},
            success: function (result) {

                data = result;
                console.log(data);
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });
        return data;
    }

    function addDataGraphsWaiting() {

        console.log('Cek DataWaiting');
        var data = "";
        $.ajax({
            type: 'POST',
            url: '@Url.Action("GetDataWaiting")',

            dataType: 'json',
            async: false,
            contentType: "application/json; charset=utf-8",
            data: {},
            success: function (result) {

                data = result;
                console.log(data);
                console.log("data contoh testlah");
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });
        return data;
    }

    function addDataGraphsPO() {

        console.log('Cek DataPO');
        var data = "";
        $.ajax({
            type: 'POST',
            url: '@Url.Action("GetDataPO")',
            dataType: 'json',
            async: false,
            contentType: "application/json; charset=utf-8",
            data: {},
            success: function (result) {

                data = result;
                console.log(data);
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });
        return data;
    }

    function addDataGraphsBuyer() {

        console.log('Cek DataBuyer');

        var data = "";
        $.ajax({
            type: 'POST',
            url: '@Url.Action("GetDataBuyer")',
            dataType: 'json',
            async: false,
            contentType: "application/json; charset=utf-8",
            data: {},
            success: function (result) {

                data = result;
                console.log(data);
            },
            error: function (xhr, status, error) {
                alert(error);
            }
        });
        return data;
    }

    function testdate() {
        console.log('testdate:');
        var sx = $('#daterange-btn').data('daterangepicker').startDate.format('DD/MM/YYYY');
        var xt = $('#daterange-btn').data('daterangepicker').endDate.format('DD/MM/YYYY');
        console.log(sx);
        console.log(xt);
    }
    //method for calling chart's data with parameters
    /*function addGraphDate() {

        console.log('testdate:');
        var sx = $('#daterange-btn').data('daterangepicker').startDate;
        var xt = $('#daterange-btn').data('daterangepicker').endDate;
        console.log(sx);
        console.log(xt);
        //error handling if start date is null
        if ($("#StartDate").val() == "") {
            Q.notifyInfo("Please Choose Start Date First");

        }

        //error handling if start date more than end date
        if ($("#StartDate").val() > $("#EndDate").val() != "") {
            Q.notifyInfo("Please Choose the Right Date");
            //datafill = addDataGraph();

        }

        //get data when user choose the right date
        if ($("#StartDate").val() != "" && $("#EndDate").val() != "") {
            var data = "";
            $.ajax({
                type: 'POST',
                url: 'Dashboard/GetDateData',
                dataType: 'json',
                data: { startDate: $("#StartDate").val(), endDate: $("#EndDate").val() },
                success: function (result) {
                    data = result;
                    console.log('Cek Data 200');
                    console.log('Dashboard/GetDateData');

                    //window.location.reload();
                    console.log(data);
                    donut.setData(data);
                    //console.log(data);
                },
                error: function (xhr, status, error) {
                    alert(error);
                }
            });

            return data;
        }

    }*/


    /*function addGraphDate() {

        console.log('testdate:');
        var sx = $('#daterange-btn').data('daterangepicker').startDate;
        var xt = $('#daterange-btn').data('daterangepicker').endDate;
        console.log(sx);
        console.log(xt);
        //error handling if start date is null
        if ($("#StartDate").val() == "") {
            Q.notifyInfo("Please Choose Start Date First");

        }

        //error handling if start date more than end date
        if ($("#StartDate").val() > $("#EndDate").val() != "") {
            Q.notifyInfo("Please Choose the Right Date");
            //datafill = addDataGraph();

        }

        //get data when user choose the right date
        if ($("#StartDate").val() != "" && $("#EndDate").val() != "") {
            var data = "";
            $.ajax({
                type: 'POST',
                url: 'Dashboard/GetDateData',
                dataType: 'json',
                data: { startDate: $("#StartDate").val(), endDate: $("#EndDate").val() },
                success: function (result) {
                    data = result;
                    console.log('Cek Data 202');
                    console.log('Dashboard/GetDateData');

                    //window.location.reload();
                    console.log(data);
                    donut.setData(data);
                    //console.log(data);
                },
                error: function (xhr, status, error) {
                    alert(error);
                }
            });

            return data;
        }

    }*/

    //coba
    /*$(function () {

        var start = moment().subtract(29, 'days');
        var end = moment();

        function cb(start, end) {
            $('#reportrange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
            console.log(start.format('YYYY-MM-DD'));
            console.log(end.format('YYYY-MM-DD'));
        }

        function cobagraph(start, end) {
            console.log(start.format('YYYY-MM-DD'));
            console.log(end.format('YYYY-MM-DD'));
            //if ($("#StartDate").val() != "" && $("#EndDate").val() != "") {
            var data = "";
            $.ajax({
                type: 'POST',
                url: 'Dashboard/GetDateData',
                dataType: 'json',
                //data: { startDate: $("#StartDate").val(), endDate: $("#EndDate").val() },
                data: { startDate: start.format('YYYY-MM-DD'), endDate: end.format('YYYY-MM-DD') },
                success: function (result) {
                    data = result;
                    console.log('Cek Data 222 ');
                    console.log('Dashboard/GetDateData');

                    //window.location.reload();
                    console.log(data);
                    donut.setData(data);
                    //console.log(data);
                },
                error: function (xhr, status, error) {
                    alert(error);
                }
            });

            return data;
        }

        $('#reportrange').daterangepicker({
            startDate: start,
            endDate: end,
            ranges: {
                'Today': [moment(), moment()],
                'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                'This Month': [moment().startOf('month'), moment().endOf('month')],
                'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
            }
        }, cobagraph);
        //});

        cb(start, end);
        cobagraph(start, end);
        datafill = cobagraph(start, end);
        //console.log(start);
        //console.log(end);

    });*/

    /*(function () {
        //Initialize Select2 Elements
        $(".select2").select2();

        //Datemask dd/mm/yyyy
        $("#datemask").inputmask("yyyy-mm-dd", { "placeholder": "yyyy-mm-dd" });
        //Datemask2 mm/dd/yyyy
        $("#datemask2").inputmask("yyyy-mm-dd", { "placeholder": "yyyy-mm-dd" });
        //Money Euro
        $("[data-mask]").inputmask();

        $('#daterange-btn').daterangepicker(
            {
                ranges: {
                    'Today': [moment(), moment()],
                    'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                    'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                    'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                    'This Month': [moment().startOf('month'), moment().endOf('month')],
                    'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                },
                startDate: moment().subtract(29, 'days'),
                endDate: moment()
            },
            function (start, end) {
                //$('#reportrange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'))
                $('#reportrange span').html(start.format('MM/DD/YYYY') + ' - ' + end.format('MM/DD/YYYY'))
            }
        )

        //$('#daterange-btn').click(function () {

        //});

        //Date range picker
        $('#StartDate').datepicker({ format: "yyyy-mm-dd" });
        $('#EndDate').datepicker({ format: "yyyy-mm-dd" });

        //Date range picker with time picker
        $('#reservationtime').daterangepicker({ timePicker: true, timePickerIncrement: 30, format: 'MM/DD/YYYY h:mm A' });
        //Date range as a button


    });*/



</script>
@if (Serenity.Authorization.HasPermission(ProcurementPermission.DashboardVendor) && Serenity.Authorization.Username != "admin")
{
    <script>
        var ctpuser = document.getElementById("sales-chartuser");
        var thisBarUser = new Chart(ctpuser, {
            type: 'horizontalBar',
            data:
            {
                labels: resultHorizontallabelUser,
                datasets: [{
                    label: 'Proses Pengadaan',
                    backgroundColor: "rgba(55, 160, 225, 0.7)",
                    hoverBackgroundColor: "rgba(55, 160, 225, 0.7)",
                    data: resultHorizontalUser
                }]
            },
            options: barOptions,
        });
        ctpuser.onclick = function (e) {
            var slice = thisBarUser.getElementAtEvent(e);
            if (!slice.length) return; // return if not clicked on slice
            var label = slice[0]._model.label;
            switch (label) {
                case '[F1] Pemilihan & Penyesuaian Bidder List':
                    window.open('Procurement/F1_BLSelectionAdjustment');
                    break;
                case '[F2] Pembuatan Dokumen Pengadaan':
                    window.open('Procurement/F2_ProcurementDocCreation');
                    break;
                case '[F3] Pembuatan RFQ':
                    window.open('Procurement/F3_CreateRFQ');
                    break;
                case '[F3-1] Input Harga OE':
                    window.open('Procurement/F3_1_InputOwnerEstimate');
                    break;
                case '[F4] Aanwijzing':
                    window.open('Procurement/F4_Aanwijzing');
                    break;
                case '[F5] Pengiriman dokumen penawaran':
                    window.open('Procurement/F5_SubmitTenderDocument');
                    break;
                case '[F5-1] Pengiriman dokumen penawaran':
                    window.open('Procurement/F1_BLSelectionAdjustment');
                    break;
                case '[F6] Pembukaan dokumen penawaran ':
                    window.open('Procurement/F6_OpenTenderDocument');
                    break;
                case '[F7] Evaluasi Penawaran':
                    window.open('Procurement/F7_TenderEvaluation');
                    break;
                case '[F8] Klarifikasi Teknis':
                    window.open('Procurement/F8_TechnicalClarification');
                    break;
                case '[F9] Evaluasi Harga':
                    window.open('Procurement/F9_PriceEvaluation');
                    break;
                case '[F10] Negosiasi':
                    window.open('Procurement/F10_Negotiation');
                    break;
                case '[F11] Pengusulan calon pemenang':
                    window.open('Procurement/F11_ProposeWinner');
                    break;
                case '[F11-REJ] Dibatalkan berdasarkan hasil pengusulan calon pemenang':
                    window.open('Procurement/F1_BLSelectionAdjustment');
                    break;
                case '[F12] Proc AS':
                    window.open('Procurement/F12_ProcAs');
                    break;
                case '[F12-REJ] Dibatalkan berdasarkan hasil Proc AS':
                    window.open('Procurement/F1_BLSelectionAdjustment');
                    break;
                case '[F13] Keputusan Penetapan':
                    window.open('Procurement/F13_ProcResultDecision');
                    break;
                case '[F13-REJ] Dibatalkan berdasarkan keputusan penetapan':
                    window.open('Procurement/F1_BLSelectionAdjustment');
                    break;
                case '[F14] Pengumuman Pemenang':
                    window.open('Procurement/F14_WinnerAnnouncement');
                    break;
                case '[F15] Proses Sanggahan':
                    window.open('Procurement/F15_ObjectionProcess');
                    break;
                case '[F16] Penunjukan Pemenang':
                    window.open('Procurement/F16_WinnerDesignation');
                    break;
                case '[F17] Upload Dokumen PO':
                    window.open('Procurement/F17_PurchOrderDocUpload');
                    break;
                case '[F18] Penugasan Buyer':
                    break;
                case '[F18-1] Tambah PR':
                    break;
                case '[F18-2] Penugasan Buyer':
                    break;
            }
        };
    </script>
}
@if (Serenity.Authorization.HasPermission(ProcurementPermission.DashboardAdmin) && Serenity.Authorization.Username != "Vendor")
{
    <script>    
        var ctp = document.getElementById("sales-chartx");
        var thisBar = new Chart(ctp, {
            type: 'horizontalBar',
            data: {
                labels: resultHorizontallabel,
                datasets: [{
                    label: 'Proses Pengadaan',
                    backgroundColor: "rgba(55, 160, 225, 0.7)",
                    hoverBackgroundColor: "rgba(55, 160, 225, 0.7)",
                    data: resultHorizontal
                }]
            },
            options: barOptions,
        });

        ctp.onclick = function (e) {
            var slice = thisBar.getElementAtEvent(e);
            if (!slice.length) return; // return if not clicked on slice
            var label = slice[0]._model.label;
            switch (label) {
                case '[F1] Pemilihan & Penyesuaian Bidder List':
                    window.open('Procurement/F1_BLSelectionAdjustment');
                    break;
                case '[F2] Pembuatan Dokumen Pengadaan':
                    window.open('Procurement/F2_ProcurementDocCreation');
                    break;
                case '[F3] Pembuatan RFQ':
                    window.open('Procurement/F3_CreateRFQ');
                    break;
                case '[F3-1] Input Harga OE':
                    window.open('Procurement/F3_1_InputOwnerEstimate');
                    break;
                case '[F4] Aanwijzing':
                    window.open('Procurement/F4_Aanwijzing');
                    break;
                case '[F5] Pengiriman dokumen penawaran':
                    window.open('Procurement/F5_SubmitTenderDocument');
                    break;
                case '[F5-1] Pengiriman dokumen penawaran':
                    window.open('Procurement/F1_BLSelectionAdjustment');
                    break;
                case '[F6] Pembukaan dokumen penawaran ':
                    window.open('Procurement/F6_OpenTenderDocument');
                    break;
                case '[F7] Evaluasi Penawaran':
                    window.open('Procurement/F7_TenderEvaluation');
                    break;
                case '[F8] Klarifikasi Teknis':
                    window.open('Procurement/F8_TechnicalClarification');
                    break;
                case '[F9] Evaluasi Harga':
                    window.open('Procurement/F9_PriceEvaluation');
                    break;
                case '[F10] Negosiasi':
                    window.open('Procurement/F10_Negotiation');
                    break;
                case '[F11] Pengusulan calon pemenang':
                    window.open('Procurement/F11_ProposeWinner');
                    break;
                case '[F11-REJ] Dibatalkan berdasarkan hasil pengusulan calon pemenang':
                    window.open('Procurement/F1_BLSelectionAdjustment');
                    break;
                case '[F12] Proc AS':
                    window.open('Procurement/F12_ProcAs');
                    break;
                case '[F12-REJ] Dibatalkan berdasarkan hasil Proc AS':
                    window.open('Procurement/F1_BLSelectionAdjustment');
                    break;
                case '[F13] Keputusan Penetapan':
                    window.open('Procurement/F13_ProcResultDecision');
                    break;
                case '[F13-REJ] Dibatalkan berdasarkan keputusan penetapan':
                    window.open('Procurement/F1_BLSelectionAdjustment');
                    break;
                case '[F14] Pengumuman Pemenang':
                    window.open('Procurement/F14_WinnerAnnouncement');
                    break;
                case '[F15] Proses Sanggahan':
                    window.open('Procurement/F15_ObjectionProcess');
                    break;
                case '[F16] Penunjukan Pemenang':
                    window.open('Procurement/F16_WinnerDesignation');
                    break;
                case '[F17] Upload Dokumen PO':
                    window.open('Procurement/F17_PurchOrderDocUpload');
                    break;
                case '[F18] Penugasan Buyer':
                    break;
                case '[F18-1] Tambah PR':
                    break;
                case '[F18-2] Penugasan Buyer':
                    break;
            }
        };</script>
}